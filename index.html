<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æˆäººè¯†å­—å­¦ä¹  - ç§»åŠ¨è¯­éŸ³ç‰ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Microsoft YaHei', 'SimHei', sans-serif;
            line-height: 1.6;
            background-color: #f5f9ff;
            color: #333;
            padding: 0;
            max-width: 100%;
            margin: 0 auto;
            overflow-x: hidden;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px 15px;
            background: linear-gradient(135deg, #4b6cb7, #182848);
            color: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 1.8rem;
            margin-bottom: 8px;
            word-wrap: break-word;
        }
        
        .header p {
            font-size: 0.95rem;
            opacity: 0.9;
        }
        
        .container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 30px;
            padding: 0 15px;
        }
        
        .category-filter {
            display: flex;
            flex-wrap: nowrap;
            gap: 8px;
            margin-bottom: 15px;
            overflow-x: auto;
            padding-bottom: 5px;
            -webkit-overflow-scrolling: touch;
        }
        
        .category-btn {
            padding: 8px 14px;
            background: #e2e8f0;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
            font-size: 0.9rem;
        }
        
        .category-btn.active {
            background: #3b82f6;
            color: white;
        }
        
        .word-list-container {
            background: white;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            max-height: 300px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .word-list h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #4b6cb7;
            font-size: 1.3rem;
            position: sticky;
            top: 0;
            background: white;
            z-index: 1;
        }
        
        .word-item {
            padding: 12px 10px;
            margin: 8px 0;
            background: #f8fafc;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid #4b6cb7;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }
        
        .word-item:hover {
            background: #e8f4ff;
        }
        
        .word-item.active {
            background: #dbeafe;
            border-left-color: #1d4ed8;
            font-weight: bold;
        }
        
        .word-char {
            font-size: 1.5rem;
            font-weight: bold;
            color: #1e40af;
            margin-right: 10px;
            min-width: 45px;
        }
        
        .word-pinyin {
            color: #64748b;
            flex-grow: 1;
        }
        
        .word-display {
            background: white;
            border-radius: 12px;
            padding: 20px 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            min-height: 300px;
            display: flex;
            flex-direction: column;
        }
        
        .chinese-character {
            font-size: 4.5rem;
            text-align: center;
            margin: 15px 0;
            color: #1e40af;
            font-weight: bold;
        }
        
        .pinyin {
            font-size: 1.6rem;
            text-align: center;
            color: #64748b;
            margin-bottom: 20px;
        }
        
        .audio-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            justify-content: center;
        }
        
        .audio-btn {
            padding: 10px 15px;
            background: #3b82f6;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 6px;
            color: white;
            flex: 1;
            justify-content: center;
            max-width: 150px;
            transition: all 0.3s;
        }
        
        .audio-btn:hover {
            background: #2563eb;
        }
        
        .audio-btn:active {
            transform: scale(0.98);
        }
        
        .audio-btn-secondary {
            background: #10b981;
        }
        
        .audio-btn-secondary:hover {
            background: #0da271;
        }
        
        .audio-status {
            padding: 10px;
            margin-top: 10px;
            background: #e8f7ff;
            border-radius: 8px;
            text-align: center;
            display: none;
            color: #1e40af;
            font-weight: bold;
        }
        
        .audio-status.active {
            display: block;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 0.7; }
            50% { opacity: 1; }
            100% { opacity: 0.7; }
        }
        
        .meaning {
            font-size: 1.1rem;
            line-height: 1.7;
            color: #334155;
            background: #f1f5f9;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
            margin-bottom: 20px;
            flex-grow: 1;
        }
        
        .meaning h3 {
            color: #1e3a8a;
            margin-bottom: 12px;
            font-size: 1.2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .usage {
            padding: 18px;
            background: #fef7e6;
            border-radius: 8px;
            border-left: 4px solid #f59e0b;
            flex-grow: 1;
        }
        
        .usage h4 {
            color: #92400e;
            margin-bottom: 10px;
            font-size: 1.2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .usage-example {
            font-size: 1rem;
            color: #78350f;
            line-height: 1.6;
        }
        
        .controls {
            text-align: center;
            margin-top: 20px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            padding: 0 15px;
        }
        
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 50px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            flex: 1;
            min-width: 120px;
            max-width: 160px;
        }
        
        .btn-prev {
            background: #64748b;
            color: white;
        }
        
        .btn-next {
            background: #3b82f6;
            color: white;
        }
        
        .btn-voice {
            background: #10b981;
            color: white;
        }
        
        .btn-stop {
            background: #ef4444;
            color: white;
        }
        
        .btn:active {
            transform: scale(0.96);
        }
        
        .footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px 15px;
            color: #64748b;
            font-size: 0.85rem;
            border-top: 1px solid #e2e8f0;
            background: white;
        }
        
        .footer p {
            margin-bottom: 8px;
        }
        
        .progress-indicator {
            text-align: center;
            margin: 15px 0;
            font-size: 0.9rem;
            color: #64748b;
        }
        
        /* éŸ³é¢‘æ’­æ”¾å™¨æ ·å¼ */
        .audio-player {
            width: 100%;
            margin: 10px 0;
        }
        
        .audio-player audio {
            width: 100%;
        }
        
        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* è§¦æ‘¸åé¦ˆ */
        .touch-feedback {
            position: fixed;
            width: 60px;
            height: 60px;
            background: rgba(59, 130, 246, 0.2);
            border-radius: 50%;
            pointer-events: none;
            transform: translate(-50%, -50%);
            z-index: 1000;
            animation: ripple 0.6s ease-out;
        }
        
        @keyframes ripple {
            0% {
                width: 0;
                height: 0;
                opacity: 0.7;
            }
            100% {
                width: 100px;
                height: 100px;
                opacity: 0;
            }
        }
        
        /* æ¨ªå±é€‚é… */
        @media (orientation: landscape) and (max-height: 500px) {
            .container {
                flex-direction: row;
            }
            
            .word-list-container {
                max-height: 250px;
                flex: 1;
            }
            
            .word-display {
                flex: 2;
            }
        }
        
        /* å¹³æ¿å’Œè¾ƒå¤§æ‰‹æœº */
        @media (min-width: 768px) {
            body {
                max-width: 768px;
                margin: 0 auto;
            }
            
            .header h1 {
                font-size: 2.2rem;
            }
            
            .chinese-character {
                font-size: 5rem;
            }
        }
        
        /* éšè—æ»šåŠ¨æ¡ä½†ä¿ç•™åŠŸèƒ½ */
        .word-list-container::-webkit-scrollbar {
            width: 4px;
        }
        
        .word-list-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        .word-list-container::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>æˆäººè¯†å­—å­¦ä¹ </h1>
        <p>ç‚¹å‡»æ±‰å­—å¯å¬è¯­éŸ³è§£é‡Šï¼Œä¸“ä¸ºç§»åŠ¨ç«¯ä¼˜åŒ–</p>
    </div>
    
    <div class="progress-indicator">
        å½“å‰å­¦ä¹ : <span id="currentProgress">1</span>/<span id="totalWords">50</span>
    </div>
    
    <div class="category-filter" id="categoryFilter">
        <button class="category-btn active" data-category="all">å…¨éƒ¨æ±‰å­—</button>
        <button class="category-btn" data-category="personal">ä¸ªäººç›¸å…³</button>
        <button class="category-btn" data-category="family">å®¶äººç§°å‘¼</button>
        <button class="category-btn" data-category="numbers">æ•°å­—</button>
        <button class="category-btn" data-category="directions">æ–¹å‘ä½ç½®</button>
        <button class="category-btn" data-category="life">æ—¥å¸¸ç”Ÿæ´»</button>
    </div>
    
    <div class="container">
        <div class="word-list-container">
            <div class="word-list" id="wordList">
                <h2>æ±‰å­—åˆ—è¡¨</h2>
                <!-- æ±‰å­—åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <div class="word-display" id="wordDisplay">
            <div class="chinese-character" id="chineseChar">äºº</div>
            <div class="pinyin" id="pinyin">rÃ©n</div>
            
            <div class="audio-controls">
                <button class="audio-btn" id="playMeaningBtn">
                    <span class="audio-icon">ğŸ”Š</span> å¬è§£é‡Š
                </button>
                <button class="audio-btn audio-btn-secondary" id="playUsageBtn">
                    <span class="audio-icon">ğŸ”Š</span> å¬ä¾‹å¥
                </button>
            </div>
            
            <div class="audio-status" id="audioStatus">
                è¯­éŸ³æ’­æ”¾ä¸­...
            </div>
            
            <div class="meaning" id="meaning">
                <h3>
                    <span>æ„æ€è§£é‡Š</span>
                    <button class="audio-btn" id="playMeaningSmallBtn" style="font-size: 0.8rem; padding: 4px 10px;">
                        <span class="audio-icon">ğŸ”Š</span>
                    </button>
                </h3>
                <p>äººç±»ï¼Œæœ‰æ™ºæ…§ã€èƒ½åˆ¶é€ å’Œä½¿ç”¨å·¥å…·è¿›è¡ŒåŠ³åŠ¨çš„é«˜ç­‰åŠ¨ç‰©ã€‚ä¹ŸæŒ‡æŸç§äººï¼Œæˆ–æŒ‡äººçš„å“è´¨ã€æ€§æ ¼ã€‚</p>
            </div>
            
            <div class="usage" id="usage">
                <h4>
                    <span>ä½¿ç”¨ç¤ºä¾‹</span>
                    <button class="audio-btn" id="playUsageSmallBtn" style="font-size: 0.8rem; padding: 4px 10px;">
                        <span class="audio-icon">ğŸ”Š</span>
                    </button>
                </h4>
                <p class="usage-example">1. æˆ‘æ˜¯ä¸€ä¸ªä¸­å›½äººã€‚<br>
                2. è¿™ä¸ªäººå¿ƒåœ°å–„è‰¯ã€‚<br>
                3. ä»Šå¤©å…¬å›­é‡Œäººå¾ˆå¤šã€‚</p>
            </div>
        </div>
    </div>
    
    <div class="controls">
        <button class="btn btn-prev" id="prevBtn">
            <span class="btn-icon">â—€</span> ä¸Šä¸€ä¸ª
        </button>
        <button class="btn btn-voice" id="voiceBtn">
            <span class="btn-icon">ğŸ”Š</span> æ’­æ”¾è§£é‡Š
        </button>
        <button class="btn btn-stop" id="stopBtn">
            <span class="btn-icon">â¹</span> åœæ­¢æ’­æ”¾
        </button>
        <button class="btn btn-next" id="nextBtn">
            ä¸‹ä¸€ä¸ª <span class="btn-icon">â–¶</span>
        </button>
    </div>
    
    <div class="footer">
        <p>ä¸“ä¸ºæˆäººè¯†å­—å­¦ä¹ è®¾è®¡ | å¤§å­—ä½“å±•ç¤º | è¯­éŸ³è§£é‡ŠåŠŸèƒ½ | ç§»åŠ¨ç«¯ä¼˜åŒ–</p>
        <p>æç¤ºï¼šç‚¹å‡»æ±‰å­—å¯å¬è§£é‡Šï¼Œå·¦å³æ»‘åŠ¨å¯åˆ‡æ¢æ±‰å­—</p>
    </div>

    <script>
        // æ±‰å­—æ•°æ®ï¼ˆåŒ…å«éŸ³é¢‘æ–‡ä»¶è·¯å¾„ï¼‰
        const words = [
            {
                char: "äºº",
                pinyin: "rÃ©n",
                meaning: "äººç±»ï¼Œæœ‰æ™ºæ…§ã€èƒ½åˆ¶é€ å’Œä½¿ç”¨å·¥å…·è¿›è¡ŒåŠ³åŠ¨çš„é«˜ç­‰åŠ¨ç‰©ã€‚ä¹ŸæŒ‡æŸç§äººï¼Œæˆ–æŒ‡äººçš„å“è´¨ã€æ€§æ ¼ã€‚",
                usage: "1. æˆ‘æ˜¯ä¸€ä¸ªä¸­å›½äººã€‚<br>2. è¿™ä¸ªäººå¿ƒåœ°å–„è‰¯ã€‚<br>3. ä»Šå¤©å…¬å›­é‡Œäººå¾ˆå¤šã€‚",
                category: "personal",
                audio: {
                    meaning: "audio/äºº_meaning.mp3",
                    usage: "audio/äºº_usage.mp3"
                }
            },
            {
                char: "æˆ‘",
                pinyin: "wÇ’",
                meaning: "è‡ªç§°ï¼Œè‡ªå·±ã€‚è¡¨ç¤ºç¬¬ä¸€äººç§°ã€‚",
                usage: "1. æˆ‘æ˜¯å­¦ç”Ÿã€‚<br>2. æˆ‘å–œæ¬¢è¯»ä¹¦ã€‚<br>3. æˆ‘çš„å®¶åœ¨æ²³å—ã€‚",
                category: "personal",
                audio: {
                    meaning: "audio/æˆ‘_meaning.mp3",
                    usage: "audio/æˆ‘_usage.mp3"
                }
            },
            {
                char: "ä½ ",
                pinyin: "nÇ",
                meaning: "ç§°å¯¹æ–¹ï¼ˆä¸€ä¸ªäººï¼‰ã€‚è¡¨ç¤ºç¬¬äºŒäººç§°ã€‚",
                usage: "1. ä½ å¥½å—ï¼Ÿ<br>2. ä½ å«ä»€ä¹ˆåå­—ï¼Ÿ<br>3. ä½ çš„ä¹¦åœ¨è¿™é‡Œã€‚",
                category: "personal",
                audio: {
                    meaning: "audio/ä½ _meaning.mp3",
                    usage: "audio/ä½ _usage.mp3"
                }
            },
            {
                char: "ä»–",
                pinyin: "tÄ",
                meaning: "ç§°è‡ªå·±å’Œå¯¹æ–¹ä»¥å¤–çš„æŸä¸ªäººã€‚è¡¨ç¤ºç¬¬ä¸‰äººç§°ã€‚",
                usage: "1. ä»–æ˜¯è€å¸ˆã€‚<br>2. ä»–çš„å®¶åœ¨åŒ—äº¬ã€‚<br>3. ä»–ä»Šå¤©æ²¡æ¥ã€‚",
                category: "personal",
                audio: {
                    meaning: "audio/ä»–_meaning.mp3",
                    usage: "audio/ä»–_usage.mp3"
                }
            },
            {
                char: "ä¸€",
                pinyin: "yÄ«",
                meaning: "æ•°ç›®å­—ï¼Œæœ€å°çš„æ­£æ•´æ•°ã€‚ä¹Ÿè¡¨ç¤ºç›¸åŒã€æ•´ä½“ã€‚",
                usage: "1. æˆ‘æœ‰ä¸€ä¸ªè‹¹æœã€‚<br>2. æˆ‘ä»¬ä¸€èµ·å­¦ä¹ ã€‚<br>3. ä¸€å¹´çº§ä¸€ç­ã€‚",
                category: "numbers",
                audio: {
                    meaning: "audio/ä¸€_meaning.mp3",
                    usage: "audio/ä¸€_usage.mp3"
                }
            }
        ];

        // å…¨å±€å˜é‡
        let currentIndex = 0;
        let filteredWords = [...words];
        let currentCategory = 'all';
        let currentAudio = null;
        let isPlaying = false;
        
        // è§¦æ‘¸ç›¸å…³å˜é‡
        let touchStartX = 0;
        let touchEndX = 0;

        // åˆå§‹åŒ–æ±‰å­—åˆ—è¡¨
        function initWordList() {
            const wordListElement = document.getElementById('wordList');
            // æ¸…ç©ºç°æœ‰å†…å®¹ï¼Œä½†ä¿ç•™æ ‡é¢˜
            const existingItems = document.querySelectorAll('.word-item');
            existingItems.forEach(item => item.remove());
            
            // æ›´æ–°æ€»å­—æ•°æ˜¾ç¤º
            document.getElementById('totalWords').textContent = filteredWords.length;
            
            // æ·»åŠ æ–°çš„æ±‰å­—é¡¹
            filteredWords.forEach((word, index) => {
                const wordItem = document.createElement('div');
                wordItem.className = `word-item ${index === currentIndex ? 'active' : ''}`;
                wordItem.innerHTML = `
                    <div class="word-char">${word.char}</div>
                    <div class="word-pinyin">${word.pinyin}</div>
                    <div class="category-tag">${getCategoryName(word.category)}</div>
                `;
                wordItem.addEventListener('click', () => {
                    selectWord(index);
                    // æ·»åŠ è§¦æ‘¸åé¦ˆ
                    createTouchFeedback(event);
                });
                wordListElement.appendChild(wordItem);
            });
        }

        // è·å–åˆ†ç±»åç§°
        function getCategoryName(category) {
            const categoryNames = {
                'personal': 'ä¸ªäºº',
                'family': 'å®¶åº­',
                'numbers': 'æ•°å­—',
                'directions': 'æ–¹å‘',
                'life': 'ç”Ÿæ´»'
            };
            return categoryNames[category] || 'å…¶ä»–';
        }

        // é€‰æ‹©æ±‰å­—
        function selectWord(index) {
            currentIndex = index;
            updateDisplay();
            updateWordListSelection();
            scrollToCurrentWord();
            // é€‰æ‹©æ–°å­—æ—¶åœæ­¢æ­£åœ¨æ’­æ”¾çš„éŸ³é¢‘
            stopAudio();
            // æ›´æ–°è¿›åº¦æ˜¾ç¤º
            document.getElementById('currentProgress').textContent = currentIndex + 1;
        }

        // æ›´æ–°æ˜¾ç¤ºåŒºåŸŸ
        function updateDisplay() {
            const word = filteredWords[currentIndex];
            document.getElementById('chineseChar').textContent = word.char;
            document.getElementById('pinyin').textContent = word.pinyin;
            document.getElementById('meaning').innerHTML = `
                <h3>
                    <span>æ„æ€è§£é‡Š</span>
                    <button class="audio-btn" id="playMeaningSmallBtn" style="font-size: 0.8rem; padding: 4px 10px;">
                        <span class="audio-icon">ğŸ”Š</span>
                    </button>
                </h3>
                <p>${word.meaning}</p>
            `;
            document.getElementById('usage').innerHTML = `
                <h4>
                    <span>ä½¿ç”¨ç¤ºä¾‹</span>
                    <button class="audio-btn" id="playUsageSmallBtn" style="font-size: 0.8rem; padding: 4px 10px;">
                        <span class="audio-icon">ğŸ”Š</span>
                    </button>
                </h4>
                <p class="usage-example">${word.usage}</p>
            `;
            
            // é‡æ–°ç»‘å®šå°æŒ‰é’®äº‹ä»¶
            document.getElementById('playMeaningSmallBtn').addEventListener('click', playMeaningAudio);
            document.getElementById('playUsageSmallBtn').addEventListener('click', playUsageAudio);
        }

        // æ›´æ–°æ±‰å­—åˆ—è¡¨é€‰æ‹©çŠ¶æ€
        function updateWordListSelection() {
            const wordItems = document.querySelectorAll('.word-item');
            wordItems.forEach((item, index) => {
                if (index === currentIndex) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
        }

        // æ»šåŠ¨åˆ°å½“å‰é€‰ä¸­çš„æ±‰å­—
        function scrollToCurrentWord() {
            const wordItems = document.querySelectorAll('.word-item');
            if (wordItems[currentIndex]) {
                wordItems[currentIndex].scrollIntoView({
                    behavior: 'smooth',
                    block: 'nearest'
                });
            }
        }

        // æŒ‰åˆ†ç±»ç­›é€‰
        function setupCategoryFilter() {
            const filterButtons = document.querySelectorAll('.category-btn');
            filterButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // æ›´æ–°æŒ‰é’®çŠ¶æ€
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    
                    // è·å–åˆ†ç±»
                    currentCategory = this.getAttribute('data-category');
                    
                    // ç­›é€‰æ±‰å­—
                    if (currentCategory === 'all') {
                        filteredWords = [...words];
                    } else {
                        filteredWords = words.filter(word => word.category === currentCategory);
                    }
                    
                    // é‡ç½®ç´¢å¼•å¹¶æ›´æ–°æ˜¾ç¤º
                    currentIndex = 0;
                    initWordList();
                    updateDisplay();
                    // åœæ­¢éŸ³é¢‘
                    stopAudio();
                });
            });
        }

        // éŸ³é¢‘æ’­æ”¾åŠŸèƒ½
        function playAudio(audioUrl) {
            // åœæ­¢å½“å‰éŸ³é¢‘
            stopAudio();
            
            if (!audioUrl) {
                showMessage("æŠ±æ­‰ï¼Œè¯¥éŸ³é¢‘æš‚æ—¶æ— æ³•æ’­æ”¾", "error");
                return;
            }
            
            // åˆ›å»ºéŸ³é¢‘å®ä¾‹
            currentAudio = new Audio(audioUrl);
            
            // æ˜¾ç¤ºæ’­æ”¾çŠ¶æ€
            document.getElementById('audioStatus').classList.add('active');
            isPlaying = true;
            
            // éŸ³é¢‘åŠ è½½äº‹ä»¶
            currentAudio.addEventListener('canplaythrough', function() {
                // éŸ³é¢‘å¯ä»¥æ’­æ”¾
                this.play().catch(e => {
                    console.error('æ’­æ”¾å¤±è´¥:', e);
                    showMessage("æ’­æ”¾å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–éŸ³é¢‘æ–‡ä»¶", "error");
                    document.getElementById('audioStatus').classList.remove('active');
                    isPlaying = false;
                });
            });
            
            // éŸ³é¢‘é”™è¯¯äº‹ä»¶
            currentAudio.addEventListener('error', function(e) {
                console.error('éŸ³é¢‘åŠ è½½é”™è¯¯:', e);
                showMessage("éŸ³é¢‘åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥", "error");
                document.getElementById('audioStatus').classList.remove('active');
                isPlaying = false;
                currentAudio = null;
            });
            
            // éŸ³é¢‘ç»“æŸäº‹ä»¶
            currentAudio.addEventListener('ended', function() {
                document.getElementById('audioStatus').classList.remove('active');
                isPlaying = false;
                currentAudio = null;
            });
            
            // å°è¯•æ’­æ”¾
            currentAudio.play().catch(e => {
                console.error('è‡ªåŠ¨æ’­æ”¾å¤±è´¥:', e);
                // å¦‚æœè‡ªåŠ¨æ’­æ”¾å¤±è´¥ï¼Œæ˜¾ç¤ºæç¤ºè®©ç”¨æˆ·æ‰‹åŠ¨ç‚¹å‡»æ’­æ”¾
                showMessage("ç‚¹å‡»æ’­æ”¾æŒ‰é’®æ”¶å¬è¯­éŸ³è§£é‡Š", "info");
                document.getElementById('audioStatus').classList.remove('active');
                isPlaying = false;
            });
        }

        // åœæ­¢éŸ³é¢‘
        function stopAudio() {
            if (currentAudio) {
                currentAudio.pause();
                currentAudio.currentTime = 0;
                document.getElementById('audioStatus').classList.remove('active');
                isPlaying = false;
                currentAudio = null;
            }
        }

        // æ’­æ”¾å½“å‰å­—çš„è§£é‡ŠéŸ³é¢‘
        function playMeaningAudio() {
            const word = filteredWords[currentIndex];
            if (word.audio && word.audio.meaning) {
                playAudio(word.audio.meaning);
            } else {
                // å¦‚æœæ²¡æœ‰é¢„å®šä¹‰éŸ³é¢‘ï¼Œä½¿ç”¨é»˜è®¤è·¯å¾„
                const defaultAudioUrl = `audio/${word.char}_meaning.mp3`;
                playAudio(defaultAudioUrl);
            }
        }

        // æ’­æ”¾å½“å‰å­—çš„ä¾‹å¥éŸ³é¢‘
        function playUsageAudio() {
            const word = filteredWords[currentIndex];
            if (word.audio && word.audio.usage) {
                playAudio(word.audio.usage);
            } else {
                // å¦‚æœæ²¡æœ‰é¢„å®šä¹‰éŸ³é¢‘ï¼Œä½¿ç”¨é»˜è®¤è·¯å¾„
                const defaultAudioUrl = `audio/${word.char}_usage.mp3`;
                playAudio(defaultAudioUrl);
            }
        }

        // æ’­æ”¾å®Œæ•´è§£é‡Šï¼ˆè§£é‡Š+ä¾‹å¥ï¼‰
        function playFullExplanation() {
            // è¿™é‡Œå¯ä»¥æ’­æ”¾ä¸€ä¸ªåˆå¹¶çš„éŸ³é¢‘ï¼Œæˆ–è€…å…ˆæ’­æ”¾è§£é‡Šå†æ’­æ”¾ä¾‹å¥
            // ç›®å‰æˆ‘ä»¬å…ˆæ’­æ”¾è§£é‡Š
            playMeaningAudio();
        }

        // æ˜¾ç¤ºæ¶ˆæ¯æç¤º
        function showMessage(message, type = "info") {
            const statusEl = document.getElementById('audioStatus');
            statusEl.textContent = message;
            statusEl.classList.add('active');
            
            // æ ¹æ®ç±»å‹è®¾ç½®ä¸åŒé¢œè‰²
            if (type === "error") {
                statusEl.style.background = "#fee2e2";
                statusEl.style.color = "#991b1b";
            } else if (type === "info") {
                statusEl.style.background = "#e8f7ff";
                statusEl.style.color = "#1e40af";
            }
            
            // 3ç§’åè‡ªåŠ¨éšè—
            setTimeout(() => {
                statusEl.classList.remove('active');
                // é‡ç½®æ ·å¼
                statusEl.style.background = "";
                statusEl.style.color = "";
            }, 3000);
        }

        // æ·»åŠ ä¸Šä¸€ä¸ªæŒ‰é’®åŠŸèƒ½
        function prevWord() {
            if (currentIndex > 0) {
                currentIndex--;
                selectWord(currentIndex);
            }
        }

        // æ·»åŠ ä¸‹ä¸€ä¸ªæŒ‰é’®åŠŸèƒ½
        function nextWord() {
            if (currentIndex < filteredWords.length - 1) {
                currentIndex++;
                selectWord(currentIndex);
            }
        }

        // åˆå§‹åŒ–éŸ³é¢‘æŒ‰é’®äº‹ä»¶
        function setupAudioButtons() {
            // ä¸»è¦éŸ³é¢‘æŒ‰é’®
            document.getElementById('voiceBtn').addEventListener('click', playFullExplanation);
            document.getElementById('stopBtn').addEventListener('click', stopAudio);
            
            // å°éŸ³é¢‘æŒ‰é’®ï¼ˆè§£é‡ŠåŒºåŸŸï¼‰
            document.getElementById('playMeaningBtn').addEventListener('click', playMeaningAudio);
            document.getElementById('playUsageBtn').addEventListener('click', playUsageAudio);
            
            // ä¸Šä¸‹ä¸€ä¸ªæŒ‰é’®
            document.getElementById('prevBtn').addEventListener('click', prevWord);
            document.getElementById('nextBtn').addEventListener('click', nextWord);
        }

        // æ·»åŠ è§¦æ‘¸åé¦ˆæ•ˆæœ
        function createTouchFeedback(event) {
            const feedback = document.createElement('div');
            feedback.className = 'touch-feedback';
            
            const x = event.clientX || event.touches[0].clientX;
            const y = event.clientY || event.touches[0].clientY;
            
            feedback.style.left = x + 'px';
            feedback.style.top = y + 'px';
            
            document.body.appendChild(feedback);
            
            // åŠ¨ç”»ç»“æŸåç§»é™¤å…ƒç´ 
            setTimeout(() => {
                feedback.remove();
            }, 600);
        }

        // è®¾ç½®è§¦æ‘¸æ»‘åŠ¨äº‹ä»¶
        function setupTouchEvents() {
            const wordDisplay = document.getElementById('wordDisplay');
            
            wordDisplay.addEventListener('touchstart', function(event) {
                touchStartX = event.changedTouches[0].screenX;
            }, {passive: true});
            
            wordDisplay.addEventListener('touchend', function(event) {
                touchEndX = event.changedTouches[0].screenX;
                handleSwipe();
            }, {passive: true});
        }

        // å¤„ç†æ»‘åŠ¨åŠ¨ä½œ
        function handleSwipe() {
            const swipeThreshold = 50; // æœ€å°æ»‘åŠ¨è·ç¦»
            const diff = touchStartX - touchEndX;
            
            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    // å‘å·¦æ»‘åŠ¨ï¼Œä¸‹ä¸€ä¸ª
                    nextWord();
                } else {
                    // å‘å³æ»‘åŠ¨ï¼Œä¸Šä¸€ä¸ª
                    prevWord();
                }
            }
        }

        // åˆå§‹åŒ–
        function init() {
            initWordList();
            updateDisplay();
            setupCategoryFilter();
            setupAudioButtons();
            setupTouchEvents();
            
            // æ·»åŠ é”®ç›˜æ”¯æŒï¼ˆç§»åŠ¨ç«¯å¤–æ¥é”®ç›˜æ—¶æœ‰ç”¨ï¼‰
            document.addEventListener('keydown', function(e) {
                if (e.key === 'ArrowLeft') {
                    prevWord();
                } else if (e.key === 'ArrowRight') {
                    nextWord();
                } else if (e.key === ' ' || e.key === 'Spacebar') {
                    // ç©ºæ ¼é”®æ’­æ”¾/åœæ­¢éŸ³é¢‘
                    e.preventDefault();
                    if (isPlaying) {
                        stopAudio();
                    } else {
                        playFullExplanation();
                    }
                } else if (e.key === 'Escape') {
                    // ESCé”®åœæ­¢éŸ³é¢‘
                    stopAudio();
                }
            });
            
            // æ£€æŸ¥éŸ³é¢‘æ”¯æŒ
            if (!window.Audio) {
                showMessage("æ‚¨çš„è®¾å¤‡å¯èƒ½ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾åŠŸèƒ½", "error");
            }
            
            // æ·»åŠ å…¨å±€ç‚¹å‡»è§¦æ‘¸åé¦ˆ
            document.addEventListener('touchstart', function(event) {
                // ä¸ºæŒ‰é’®æ·»åŠ è§¦æ‘¸åé¦ˆ
                if (event.target.tagName === 'BUTTON' || event.target.closest('button')) {
                    createTouchFeedback(event);
                }
            }, {passive: true});
            
            // æ·»åŠ å…¨å±€ç‚¹å‡»äº‹ä»¶ï¼Œé˜²æ­¢æŒ‰é’®ç‚¹å‡»åä¿æŒactiveçŠ¶æ€
            document.addEventListener('touchend', function() {
                // ç§»é™¤æ‰€æœ‰æŒ‰é’®çš„activeçŠ¶æ€
                document.querySelectorAll('button').forEach(btn => {
                    btn.blur();
                });
            }, {passive: true});
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
